webpackJsonp([6],{561:function(t,e,a){a(595);var i=a(222)(a(573),a(612),"data-v-05b05e86",null);t.exports=i.exports},573:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(223),r=a.n(i);e.default={data:function(){function t(t,e,a){/[^a-zA-Z0-9_\/]/g.test(e)?a(new Error("不能存在特殊字符，只能是英文字符、_、/等！")):a()}return{winWidth:window.innerWidth,winHeight:window.innerHeight,form:{Id:this.$route.query.apiId,Title:"",Description:"",ApiTitle:"",CateId:"",Methods:"GET",InputParams:[],OutputParams:[],ProductId:this.$route.query.proId},formRules:{Title:[{required:!0,message:"api接口名不能为空！",trigger:"blur"},{validator:t,trigger:"blur"}],Methods:[{required:!0,message:"请选择请求方式！",trigger:"blur"}],ApiTitle:[{required:!0,message:"api中文名不能为空！",trigger:"blur"}],CateId:[{type:"number",required:!0,message:"请选择api所属的分类！",trigger:"blur"}]},formLabelWidth:"120px",categoryList:[],isAddCateInputShow:!1,addCateInput:"",newCateId:null}},methods:{getDataList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$http.get("/category/cateList",{params:{ps:999,ProductId:this.$route.query.proId}}).then(function(a){200==a.data.code?(t.categoryList=a.data.data.map(function(a){return e&&a.Id==t.newCateId&&(t.form.CateId=+t.newCateId),r()({},{label:a.Title,value:a.Id})}),t.getDetail()):t.$message.error(a.data.description)})},getDetail:function(){var t=this;this.$http.get("/api/detail",{params:{ApiId:this.$route.query.apiId}}).then(function(e){200==e.data.code?(e.data.data.InputParams=e.data.data.InputParams.map(function(t){return t.IsNecessary=0!==t.IsNecessary,t}),t.form=e.data.data):t.$message.error(e.data.description)})},createOrUpdate:function(){var t=this;this.$refs.apiDetail.validate(function(e){e&&t.$http.post("/api/createOrUpdate",t.form).then(function(e){200==e.data.code?(t.$message.success(e.data.description),setTimeout(function(){t.$router.push({path:"/admin/apiList",query:{proId:t.$route.query.proId}})},1e3)):t.$message.error(e.data.description)})})},addCategory:function(){var t=this;if(!this.addCateInput||""==this.addCateInput.trim())return void this.$message.warning("请输入分类名！");this.$http.post("/category/createOrUpdate",{ProductId:this.$route.query.proId,Title:this.addCateInput}).then(function(e){200==e.data.code?(t.$message.success("新增分类成功！"),t.addCateInput="",t.isAddCateInputShow=!1,t.newCateId=e.data.data,t.getDataList(!0)):t.$message.error(e.data.description)})},addParams:function(t){var e={Title:"",Description:"",Type:"",Default:"",Test:"",IsNecessary:!0,ApiId:this.$route.query.apiId};1==t?this.form.InputParams.push(e):this.form.OutputParams.push({Title:"",Description:"",Type:"",ApiId:this.$route.query.apiId})},removeParams:function(t,e){1==t?this.form.InputParams.splice(e,1):this.form.OutputParams.splice(e,1)}},created:function(){this.getDataList()},mounted:function(){}}},583:function(t,e,a){e=t.exports=a(555)(!1),e.push([t.i,".add-exp-form[data-v-05b05e86]{margin:30px auto;width:90%}.exp-content[data-v-05b05e86]{margin:30px auto;width:90%;height:300px;border:1px solid #337ab7}.close-param[data-v-05b05e86]{margin-right:4px;color:#ff4949!important;font-size:24px;cursor:pointer}.close-param[data-v-05b05e86]:hover{color:red!important}.api-add-icon[data-v-05b05e86]{transform:translateY(5px);font-size:24px;cursor:pointer;color:#21b384}.api-add-icon[data-v-05b05e86]:hover{color:#13ce66}",""])},595:function(t,e,a){var i=a(583);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(556)("3468bd14",i,!0)},612:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"index-cont",style:{height:t.winHeight+"px",width:"92%",margin:"30px auto"}},[t._m(0),t._v(" "),a("div",{staticClass:"add-exp-form"},[a("el-form",{ref:"apiDetail",staticStyle:{width:"94%"},attrs:{model:t.form,"label-width":t.formLabelWidth,rules:t.formRules}},[a("el-form-item",{attrs:{label:"API名称",prop:"Title"}},[a("el-input",{attrs:{placeholder:"请输入名称","auto-complete":"off"},model:{value:t.form.Title,callback:function(e){t.$set(t.form,"Title",e)},expression:"form.Title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"中文说明",prop:"ApiTitle"}},[a("el-input",{attrs:{placeholder:"请输入中文说明","auto-complete":"off"},model:{value:t.form.ApiTitle,callback:function(e){t.$set(t.form,"ApiTitle",e)},expression:"form.ApiTitle"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"所属分类",required:""}},[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{prop:"CateId"}},[a("el-select",{attrs:{disabled:t.isAddCateInputShow,placeholder:"请选择"},model:{value:t.form.CateId,callback:function(e){t.$set(t.form,"CateId",e)},expression:"form.CateId"}},t._l(t.categoryList,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",[a("i",{directives:[{name:"show",rawName:"v-show",value:!t.isAddCateInputShow,expression:"!isAddCateInputShow"}],staticClass:"el-icon-circle-plus-outline api-add-icon",on:{click:function(e){t.isAddCateInputShow=!0}}}),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isAddCateInputShow,expression:"isAddCateInputShow"}],staticStyle:{width:"170px"},attrs:{placeholder:"请输入中文说明","auto-complete":"off"},model:{value:t.addCateInput,callback:function(e){t.addCateInput=e},expression:"addCateInput"}}),t._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:t.isAddCateInputShow,expression:"isAddCateInputShow"}],staticClass:"el-icon-circle-check api-add-icon",on:{click:t.addCategory}}),t._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:t.isAddCateInputShow,expression:"isAddCateInputShow"}],staticClass:"el-icon-circle-close api-add-icon close-param",on:{click:function(e){t.addCateInput="",t.isAddCateInputShow=!1}}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"请求方式",prop:"Methods"}},[a("el-radio",{attrs:{label:"GET",border:""},model:{value:t.form.Methods,callback:function(e){t.$set(t.form,"Methods",e)},expression:"form.Methods"}},[t._v("GET")]),t._v(" "),a("el-radio",{attrs:{label:"POST",border:""},model:{value:t.form.Methods,callback:function(e){t.$set(t.form,"Methods",e)},expression:"form.Methods"}},[t._v("POST")])],1),t._v(" "),a("el-form-item",{attrs:{label:"输入参数"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.addParams(1)}}},[t._v("新增")])],1),t._v(" "),t._l(t.form.InputParams,function(e,i){return a("el-form-item",{key:i+"input",attrs:{label:"参数 "+(i+1)}},[a("el-row",[a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:3}},[a("el-input",{attrs:{placeholder:"参数名","auto-complete":"off"},model:{value:e.Title,callback:function(a){t.$set(e,"Title",a)},expression:"item.Title"}})],1),t._v(" "),a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:5}},[a("el-input",{attrs:{placeholder:"描述","auto-complete":"off"},model:{value:e.Description,callback:function(a){t.$set(e,"Description",a)},expression:"item.Description"}})],1),t._v(" "),a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:3}},[a("el-input",{attrs:{placeholder:"类型","auto-complete":"off"},model:{value:e.Type,callback:function(a){t.$set(e,"Type",a)},expression:"item.Type"}})],1),t._v(" "),a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:4}},[a("el-input",{attrs:{placeholder:"默认值","auto-complete":"off"},model:{value:e.Default,callback:function(a){t.$set(e,"Default",a)},expression:"item.Default"}})],1),t._v(" "),a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:4}},[a("el-input",{attrs:{placeholder:"测试值","auto-complete":"off"},model:{value:e.Test,callback:function(a){t.$set(e,"Test",a)},expression:"item.Test"}})],1),t._v(" "),a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:3}},[a("el-checkbox",{model:{value:e.IsNecessary,callback:function(a){t.$set(e,"IsNecessary",a)},expression:"item.IsNecessary"}},[t._v("是否必须")])],1),t._v(" "),a("el-col",{staticClass:"close-param",attrs:{span:1}},[a("i",{staticClass:"el-icon-circle-close",on:{click:function(e){t.removeParams(1,i)}}})])],1)],1)}),t._v(" "),a("el-form-item",{attrs:{label:"输入参数"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.addParams(2)}}},[t._v("新增")])],1),t._v(" "),t._l(t.form.OutputParams,function(e,i){return a("el-form-item",{key:i+"output",attrs:{label:"参数 "+(i+1)}},[a("el-row",[a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:3}},[a("el-input",{attrs:{placeholder:"参数名","auto-complete":"off"},model:{value:e.Title,callback:function(a){t.$set(e,"Title",a)},expression:"item.Title"}})],1),t._v(" "),a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:5}},[a("el-input",{attrs:{placeholder:"描述","auto-complete":"off"},model:{value:e.Description,callback:function(a){t.$set(e,"Description",a)},expression:"item.Description"}})],1),t._v(" "),a("el-col",{staticStyle:{"margin-right":"4px"},attrs:{span:3}},[a("el-input",{attrs:{placeholder:"类型","auto-complete":"off"},model:{value:e.Type,callback:function(a){t.$set(e,"Type",a)},expression:"item.Type"}})],1),t._v(" "),a("el-col",{staticClass:"close-param",attrs:{span:1}},[a("i",{staticClass:"el-icon-circle-close",on:{click:function(e){t.removeParams(2,i)}}})])],1)],1)}),t._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{placeholder:"请输入描述",type:"textarea","auto-complete":"off",rows:"2"},model:{value:t.form.Description,callback:function(e){t.$set(t.form,"Description",e)},expression:"form.Description"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.createOrUpdate}},[t._v("确认")]),t._v(" "),a("el-button",{on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")])],1)],2)],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-page-title"},[a("h3",[t._v("\n         修改API\n       ")]),t._v(" "),a("span",{staticClass:"yellow-place"})])}]}}});